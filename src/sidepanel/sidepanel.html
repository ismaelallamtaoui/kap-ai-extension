<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>KAP.ai â€“ Panneau latÃ©ral</title>
  <!--
    On importe la feuille de styles globale pour permettre de styliser
    l'interface de "Mieux prompter" avec la palette dÃ©finie dans
    style.css. Sans cette inclusion, nos classes personnalisÃ©es ne
    bÃ©nÃ©ficieront pas des rÃ¨gles dÃ©clarÃ©es dans le fichier global.
  -->
  <!-- Chemin mis Ã  jour aprÃ¨s restructuration : remonte jusqu'Ã  la racine puis styles -->
  <link rel="stylesheet" href="../../styles/style.css" />
  <!--
    Ce fichier dÃ©finit l'interface principale du panneau latÃ©ral. Il remplace
    l'ancien popup de l'extension par une barre d'onglets et un espace
    d'affichage. Chaque onglet charge l'une des pages existantes de
    l'extension (constructeur, triage, favoris, profil) dans un iframe. Les
    pages internes conservent leur logique et leur style car elles sont
    simplement chargÃ©es dans ce cadre.
  -->
  <style>
    /* RÃ©initialise les marges et occupe toute la hauteur du panneau. */
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
    }
    /* Conteneur flex vertical pour rÃ©partir la barre et le contenu. */
    .wrapper {
      display: flex;
      flex-direction: column;
      height: 100%;
      width: 100%;
      font-family: sans-serif;
    }
    /* Barre d'onglets horizontale en haut du panneau. */
    .tab-bar {
      display: flex;
      flex-shrink: 0;
      /* Palette bleue harmonisÃ©e avec le reste de l'extension */
      background-color: #0e6cf0;
    }
    .tab-bar button {
      flex: 1;
      border: none;
      background: transparent;
      color: #fff;
      padding: 10px 8px;
      cursor: pointer;
      font-size: 0.85em;
      text-align: center;
      transition: background-color 0.2s ease;
    }
    /* Survol d'un ongletÂ : nuance de bleu lÃ©gÃ¨rement plus foncÃ©e */
    .tab-bar button:hover {
      background-color: #0b5fd6;
    }
    /* Onglet actifÂ : nuance de bleu encore plus soutenue */
    .tab-bar button.active {
      background-color: #084dbf;
    }
    /* Cadre de contenu qui occupe tout l'espace restant. */
    #contentFrame {
      flex: 1;
      border: none;
      width: 100%;
    }
  </style>
</head>
<body>
  <div class="wrapper">
    <div class="tab-bar">
      <button id="promptTab" class="active">MieuxÂ Prompter</button>
      <button id="chooseTab">QuelleÂ IAÂ choisirÂ ?</button>
      <button id="favoritesTab">MesÂ PromptsÂ Favoris</button>
      <button id="settingsTab">ParamÃ¨tres</button>
    </div>
    <!-- Conteneur pour la nouvelle section "Mieux prompter".
         Cette section est affichÃ©e uniquement lorsque l'onglet
         correspondant est actif. Elle est masquÃ©e pour les autres
         onglets. -->
    <div id="promptContainer" class="mp-container">
      <!-- Bascule entre les modes Rapide et AvancÃ© -->
      <div class="mp-mode-toggle">
        <button id="mpQuickBtn" class="mp-mode-button active" data-mode="quick">âš¡Â Rapide</button>
        <button id="mpAdvancedBtn" class="mp-mode-button" data-mode="advanced">ğŸ¯Â AvancÃ©</button>
      </div>
      <!-- Section du mode rapide -->
      <div id="mpQuickSection" class="mp-section">
        <label for="mpQuickInput" class="mp-label">Votre demandeÂ :</label>
        <textarea id="mpQuickInput" class="mp-input" rows="3" placeholder="DÃ©cris briÃ¨vement ce dont tu as besoinâ€¦"></textarea>
        <!-- Suggestions issues de la mÃ©moire locale pour le mode rapide -->
        <div id="mpQuickSuggestions" class="mp-suggestions"></div>
        <button id="mpGenerateBtn" class="mp-btn">GÃ©nÃ©rer un meilleur prompt</button>
        <!-- Affichage du prompt gÃ©nÃ©rÃ©, repliÃ© par dÃ©faut -->
        <details id="mpQuickResult" class="mp-prompt-result" style="display:none;">
          <summary>Prompt gÃ©nÃ©rÃ©</summary>
          <textarea id="mpQuickGenerated" class="mp-result" readonly></textarea>
        </details>
      </div>
      <!-- Section du mode avancÃ© -->
      <div id="mpAdvancedSection" class="mp-section" style="display:none;">
        <label for="mpAdvContext" class="mp-label">Contexte et objectifÂ :</label>
        <textarea id="mpAdvContext" class="mp-input" rows="3" placeholder="DÃ©tails, contexte, attentesâ€¦"></textarea>
        <!-- Bascule de correction automatique en mode avancÃ© -->
        <div class="mp-auto-correct-toggle">
          <span>Correction autoÂ :</span>
          <label class="mp-switch">
            <input type="checkbox" id="mpAutoCorrect" />
            <span class="mp-slider"></span>
          </label>
        </div>
        <!-- Chips de clarification intelligentes -->
        <div id="mpChips" class="mp-chips-container"></div>
        <!-- Suggestions issues de la mÃ©moire locale pour le mode avancÃ© -->
        <div id="mpAdvSuggestions" class="mp-suggestions"></div>
        <button id="mpAdvGenerateBtn" class="mp-btn">GÃ©nÃ©rer un meilleur prompt</button>
        <!-- Affichage du prompt gÃ©nÃ©rÃ© en mode avancÃ© -->
        <details id="mpAdvResult" class="mp-prompt-result" style="display:none;">
          <summary>Prompt gÃ©nÃ©rÃ©</summary>
          <textarea id="mpAdvGenerated" class="mp-result" readonly></textarea>
        </details>
        <!-- Recommandation de modÃ¨le affichÃ©e aprÃ¨s gÃ©nÃ©ration -->
        <div id="mpModelRecommendation" class="mp-model-recommendation" style="display:none;">
          <h3>ModÃ¨le recommandÃ©</h3>
          <p id="mpModelRecText"></p>
        </div>
      </div>
    </div>
    <!--
      L'iframe charge les pages existantes de l'extension. En utilisant un
      iframe, on ne modifie pas la structure interne des pages (ni leur CSS
      dÃ©finissant une largeur de 350Â px) et on prÃ©serve toutes les
      interactions JavaScript (navigation, stockage, etc.).
    -->
    <!-- Le src initial sera dÃ©fini dynamiquement via le script afin
         d'utiliser chrome.runtime.getURL pour obtenir une URL correcte. -->
    <iframe id="contentFrame"></iframe>
  </div>
  <!-- Le script est externalisÃ© pour respecter la CSP de ManifestÂ V3 -->
  <script src="sidepanel.js"></script>
</body>
</html>